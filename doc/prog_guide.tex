\documentclass{report}
\usepackage[utf8]{inputenc}
\usepackage{underscore}

\title{Map My Garage Sale: Programmer's Guide}
\author{Blake Lowe}

\begin{document}

\pagenumbering{gobble}
\maketitle
\newpage
\pagenumbering{arabic}

\tableofcontents
\newpage

\chapter{Engine}

\section{Tiles \& Grids}
Tiles and Grids are the fundamental data types upon which the rest of the
program is based. Grids are used to represent the Main Grid shown to the user,
and they are also used to represent the shape of a Stand.

Each Grid is made up of many Tiles. Each Tile represents a ``square'' on a
Grid. Tiles contain pointers to their immediately adjacent Tiles on that Grid.
The Grid, therefore, can be seen as a graph consisting of nodes which form
a rectangular matrix.

Grids keep a record of their length and width in Tiles so that their
sizes can be easily queried later.

The Grid structure keeps a pointer to its origin Tile, located in the
top-left corner of the Grid. From this Tile, you can traverse the Grid
using the links between Tiles. If the top-left Tile becomes a different Tile
(for example, due to a rotation), you should call \texttt{reset_origin}, which will
reset the origin pointer to the new location of the top-left Tile.

When referring to a specific Tile in a grid, the column of the Tile
is the number of columns to the right of the origin Tile it is, and
its row is the number of rows below the origin Tile it is.
The coordinates should be expressed as [row, column].
For example, in the following Grid:
\begin{verbatim}
A B C
D E F
G H I
\end{verbatim}
\begin{itemize}
	\item A is the origin Tile, it is at [0, 0].
	\item C is at [0, 2].
	\item H is at [2, 1].
\end{itemize}

Tiles and Grids keep all of their data on the heap. Constructors\footnote{
	\texttt{new_grid} and \texttt{clone_grid} for constructing Grids
	and \texttt{new_tile} for constructing Tiles}
and destructors\footnote{\texttt{del_grid}; Tiles can be free'd} are provided
to create and destroy these types.

To aid in access to a Grid, and to provide an easy way of iterating over all
of a Grid's Tiles, a lookup table is provided. The lookup pointer in a Grid is
an array of pointers to Tiles, which contains a pointers to each Tile in the
Grid in row-major order. To use this feature, the function \texttt{grid_lookup}
is provided, which performs the calculation necessary to find a specific Tile
given its row and column coordinates. If you perform a mutation upon the Grid
that changes the structure of its Tiles (again, rotation being a good example),
you should call \texttt{rebuild_lookup} (after ensuring the origin pointer
is correctly set), which will traverse the Grid, starting from its origin, and
recreate the lookup table.

Reverse lookups are straightforward: each Tile contains the row and column
coordinates at which it resides on its Grid. These coordinates are also
updated during a call to \texttt{rebuild_lookup}.

The currently provided mutation routines are \texttt{rotate_grid}, which
flips it 90 degrees, and \texttt{mirror_grid}, which flips the Grid structure
by moving columns of Tiles to their symmetrical opposite position.
While \texttt{mirror_grid} only mirrors a Grid along the Y axis, an X-axis
mirror can of course be synthesized easily by following a call to
\texttt{mirror_grid} with two calls to \texttt{rotate_grid}
in the same direction.

\section{Stands}

\section{Saving/Loading}
The ability to save and load the program state is an essential part of
any modern program. It is important, therefore, that the processes of
marshalling and unmarshalling the data be performed correctly.

\subsection{File Format}
We utilize an extensible, textual format to represent program data.
It is divided into several logical blocks which each represent a different
component of the program. These blocks may appear in any order. The file
is expected to be encoded in ASCII or UTF-8.

The save file shall begin with the characters ``MMGS'', followed by a colon,
then followed by the file version number, follwed by a number. The
file version number, as well as all other numbers in the file, shall be a
decimal integer spelled out using numeric characters.

The different blocks are as follows:
\begin{itemize}
	\item The \emph{standtemplates} block begins with one square-bracket
		enclosed parameter, a number telling the parser how many
		Stand Templates are expected within the block. It is an error
		for this number to not match the number of definitions within
		the block. After the close bracket shall follow an open
		parenthesis.

		Each definition will begin with a number giving the number of
		bytes in the name of the template\footnote{This is \emph{not}
			the same as the number of logical characters in the
			name. This allows for names with multi-byte characters
		to be properly encoded.}, followed by a colon,
		followed by the name itself. The name shall be followed by
		a colon, followed by two colon-separated numbers defining
		the length and width, respectively, of the Grid which
		represents the shape of the Stand Template. This shall be
		followed with a colon, a Grid Definition (see below), and
		finally terminated with a semicolon. This semicolon ends
		the Stand Template definition.

		The block shall be ended with a close parenthesis.
	\item The \emph{stands} block begins with the same parameter format as
		the standtemplates block, and it serves the same purpose:
		to inform the parser of the number of Stand definitions to
		expect.

		The format of Stand definitions inside the block are
		identical to the definitions of Stand Templates, with the
		following modifications:
		\begin{itemize}
			\item Between the name and the height/width pair
				shall be three colon-separated integers
				defining the color of the stand in
				HTML RGB notation. Naturally, these
				numbers shall be within the range 0--255.
			\item After the Grid Definition shall follow not a
				semicolon, but a colon. After this shall
				follow the row and column, respectively, of
				the location of this Stand's placement
				on the Main Grid.
		\end{itemize}
	\item The \emph{maingrid} block has no parameters, and is opened
		and closed with parenthesis. Inside of the
		block, two colon-separated integers are expected: the
		height and width, respectively, of the Main Grid.

		This block notably does not contain a Grid Definition. The
		makeup of the Main Grid is deduced from the coordinates of
\end{itemize}

The \emph{Grid Definition} is a loose block of the characters ``0'',
representing an empty Tile, and ``S'', representing a filled Tile.
These characters shall appear in row-major order, but whitespace is ignored.
It is recommended, but not required, that the program place spaces between
characters, and newlines at the end of each row of Tiles. This is expected to
improve readability.
\newpage
The following is an example of a fully-featured save file:
\begin{verbatim}
MMGS:1;

standtemplates[2](
7:L Block:4:4:
0 S 0 0
0 S 0 0
0 S S 0
0 0 0 0;

6:Square:2:2:
S S
S S;
)

stands[2](
5:Table:130:130:130:4:4:
0 0 0
S S S
S S S:
3:2;

4:Case:100:100:100:1:1:
S:
14:13;
)

maingrid(
100:100
)
\end{verbatim}

A conforming parser of MMGS files should ignore whitespace outside of the
names of Stands and Stand Templates.

\chapter{Frontend}

\section{Design}
Map My Garage Sales's User Interface was designed with the intent to make core
 functionality as accessible to the user as possible.  Ideally, the user will be able to 
get from a blank map to dragging a newly created stand onto the map in under 10 
clicks.  This should easily be possible, thus allowing them to create an effective map 
of their garage sale with minimal overhead.  

\subsection{Stand Placement \& Editing}
Our workflow will move the user to the Create New Stand button to create a new 
Stand and give it a Name, Width, Height and Color.  This Stand will then be placed
 in the list of available Stands for them to drag into the Map Area.  Each time they 
drag a Stand Template from the list of available Stands a new instance of that Stand 
will be created shown on the Map Area.


\emph{Rotate Selected Stand} - Clicking this button will rotate a specific instance of
 a Stand they have selected in the Map Area by clicking the Rotate Stand button while 
it is selected.  This will rotate the stand 90 degrees clockwise for each time they click 
the Rotate Stand button.

\emph{Rename Stand} - Clicking the Rename Stand button while a Stand Template is 
selected in the list of available Stands will bring up a dialog to rename the Stand Template.  

\begin{itemize}
	\item NOTE - This will rename all instances of the Stand on the Map Area.
\end{itemize}

\emph{Delete Selected Stand} - Clicking the Delete Selected Stand button while a 
Stand Template is selected will remove the instance of the Stand from the Map Area.

\emph{Display Grid} - The Display Grid ToggleButton will turn on grid lines if users 
find it eases the Stand placement process.

\emph{Stand Metadata} - Next to the Display Grid ToggleButton, the Name, Width
 and Height will be displayed about the currently selected Stand.

\section{Stetic \& Xamarin Studio}
The entire Frontend portion of Map My Garage Sale was developed using Xamarin
 Studio 5.  Xamarin Studio incorporates the Stetic UI designer for use with the GTK
 Sharp library.  Early on, this was the main way the User Interface was designed, but
 further experience with the designer yielded unsatisfactory results and manual
 instantiation and initialization was used to create a large portion of the GUI.

Non-generated code for User Interface initialization can be found in the SetupUI 
methods in the respective classes in the root Frontend namespace.


\section{Mono.Cairo}

\section{Map Design Area (Grid)}



\chapter{Engine--Frontend API}

\end{document}
